"use strict";(globalThis["webpackChunksyseye"]=globalThis["webpackChunksyseye"]||[]).push([[210],{7210:(e,t,i)=>{i.r(t),i.d(t,{default:()=>H});var a=i(3673),l=i(2323);const s={class:"row"},n=(0,a._)("div",{class:"col"},null,-1),d={class:"col"},o={class:"row q-gutter-md q-mb-sm q-pa-lg"},r={key:0},A=(0,a._)("div",{class:"bg-red-5"}," ",-1),c=(0,a.Uk)(" 分数: "),g=(0,a.Uk)(" 活动状态: "),h=(0,a.Uk)(" 产生的威胁: "),p=(0,a.Uk)(" 查看详情 "),u=(0,a.Uk)(" 在VT上搜索 "),m=(0,a.Uk)(" 删除报警 "),w=(0,a._)("div",{class:"col"},null,-1),B=(0,a.Uk)("Minimize"),b=(0,a.Uk)("Maximize"),C=(0,a.Uk)("Close"),Q={class:"row",style:{width:"100%",height:"100%"}},k={ref:"main_draw",style:{width:"100%",height:"100%","margin-left":"5%"}};function V(e,t,i,V,U,f){const v=(0,a.up)("q-chip"),I=(0,a.up)("q-btn"),q=(0,a.up)("q-card-actions"),_=(0,a.up)("q-card-section"),S=(0,a.up)("q-card"),D=(0,a.up)("q-timeline-entry"),y=(0,a.up)("q-timeline"),E=(0,a.up)("q-space"),x=(0,a.up)("q-tooltip"),Z=(0,a.up)("q-bar"),K=(0,a.up)("q-dialog"),Y=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",null,[(0,a._)("div",s,[n,(0,a._)("div",d,[(0,a._)("div",o,[(0,a.Wm)(y,{layout:"dense",side:"right",color:"red"},{default:(0,a.w5)((()=>[e.server_threat.data&&0!=e.server_threat.data.length?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("h4",r,"暂无可用数据...")),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.server_threat.data,((t,i)=>((0,a.wg)(),(0,a.j4)(D,{key:i,subtitle:"主机:"+t.host,side:"left"},{default:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a.Wm)(S,{flat:"",bordered:"",style:{overflow:"auto"},"thumb-style":e.thumbStyle,"bar-style":e.barStyle},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{horizontal:""},{default:(0,a.w5)((()=>[A,(0,a.Wm)(q,{vertical:"",class:"justify-around q-px-md"},{default:(0,a.w5)((()=>[(0,a._)("div",null,"进程链hash: "+(0,l.zw)(t.chain_hash),1),(0,a._)("div",null,"进程: "+(0,l.zw)(t.start_process.path),1),(0,a._)("div",null,"用户: "+(0,l.zw)(t.start_process.user),1),(0,a._)("div",null,[c,(0,a.Wm)(v,{square:"",color:"orange","text-color":"white","icon-right":"visibility"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(t.risk_score),1)])),_:2},1024)]),(0,a._)("div",null,[g,(0,a.Wm)(v,{square:"",color:1==t.is_end?"negative":"red","text-color":"white"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(1==t.is_end?"已结束":"进行中"),1)])),_:2},1032,["color"])]),(0,a._)("div",null,[h,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.hit_rule,((e,t)=>((0,a.wg)(),(0,a.j4)(v,{key:e,square:"",color:"rgb(239,243,246)"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(t)+" ("+(0,l.zw)(e)+") ",1)])),_:2},1024)))),128))]),(0,a._)("div",null,[(0,a.Wm)(I,{flat:"",color:"accent",onClick:i=>e.show_details(t.id),icon:"open_in_new"},{default:(0,a.w5)((()=>[p])),_:2},1032,["onClick"]),(0,a.Wm)(I,{flat:"",color:"accent",onClick:i=>e.search_vt(t.start_process.hash),icon:"search"},{default:(0,a.w5)((()=>[u])),_:2},1032,["onClick"]),(0,a.Wm)(I,{flat:"",color:"accent",icon:"close",onClick:i=>e.delete_threat(t.id)},{default:(0,a.w5)((()=>[m])),_:2},1032,["onClick"])])])),_:2},1024)])),_:2},1024)])),_:2},1032,["thumb-style","bar-style"])])])),_:2},1032,["subtitle"])))),128))])),_:1})])]),w])]),(0,a.Wm)(K,{modelValue:e.dialog,"onUpdate:modelValue":t[2]||(t[2]=t=>e.dialog=t),persistent:"",maximized:e.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.w5)((()=>[(0,a.Wm)(S,{class:"text-white"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[(0,a.Wm)(E),(0,a.Wm)(I,{dense:"",flat:"",icon:"minimize",onClick:t[0]||(t[0]=t=>e.maximizedToggle=!1),disable:!e.maximizedToggle},{default:(0,a.w5)((()=>[e.maximizedToggle?((0,a.wg)(),(0,a.j4)(x,{key:0,"content-class":"bg-white text-primary"},{default:(0,a.w5)((()=>[B])),_:1})):(0,a.kq)("",!0)])),_:1},8,["disable"]),(0,a.Wm)(I,{dense:"",flat:"",icon:"crop_square",onClick:t[1]||(t[1]=t=>e.maximizedToggle=!0),disable:e.maximizedToggle},{default:(0,a.w5)((()=>[e.maximizedToggle?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(x,{key:0,"content-class":"bg-white text-primary"},{default:(0,a.w5)((()=>[b])),_:1}))])),_:1},8,["disable"]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(I,{dense:"",flat:"",icon:"close"},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{"content-class":"bg-white text-primary"},{default:(0,a.w5)((()=>[C])),_:1})])),_:1})),[[Y]])])),_:1}),(0,a._)("div",Q,[(0,a._)("div",k," 1 ",512)])])),_:1})])),_:1},8,["modelValue","maximized"])],64)}var U=i(52),f=i.n(U),v=i(2256);const I=(0,a.aZ)({name:"PageIndex",data:function(){return{last_refresh:360,thumbStyle:{right:"4px",borderRadius:"5px",backgroundColor:"#027be3",width:"5px",opacity:.75},barStyle:{right:"2px",borderRadius:"9px",backgroundColor:"#027be3",width:"9px",opacity:.2},dialog:!1,maximizedToggle:!0,server_threat:{},select_chain_data:{}}},methods:{set_chain_data(e){if(e.path){const t=e.path.split("\\");e.name=t[t.length-1],console.log(e.name);for(const i in e.children)this.set_chain_data(e.children[i])}},draw_tree(){this.set_chain_data(this.select_chain_data);const e=this.$refs.main_draw,t=v.S1(e),i={tooltip:{trigger:"item",triggerOn:"mousemove",formatter:function(e){const t=e.data;let i="<div>参数: "+t.params+"</div><div> hash: "+t.md5+"</div><div>命名规则列表: ";0===t.operationlist.length&&(i+="无");for(const a in t.operationlist)i+=" "+a+"["+t.operationlist[a]+"] ";return i+="</div>",i}},series:[{roam:!0,type:"tree",id:0,name:"tree1",data:[this.select_chain_data],top:"5%",left:"15%",bottom:"22%",right:"20%",edgeShape:"polyline",edgeForkPosition:"63%",initialTreeDepth:60,lineStyle:{width:2},label:{backgroundColor:"#fff",position:"left",verticalAlign:"middle",align:"right"},leaves:{label:{position:"right",verticalAlign:"middle",align:"left"}},emphasis:{focus:"descendant"},symbolSize:[40,50],symbol:"image://data:image/png;base64,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",expandAndCollapse:!0,animationDuration:550,animationDurationUpdate:750}]};t.setOption(i)},search_vt(e){window.open("https://www.virustotal.com/gui/search/"+e,"_blank")},delete_threat(e){f().get("/api/v1/get/process_chain/delete?id="+e,{"Content-Type":"application/json"}).then((e=>{this.get_clientids()}))},show_details(e){f().get("/api/v1/get/process_chain/pull?id="+e,{"Content-Type":"application/json"}).then((e=>{const t=e.data;t.data&&(this.select_chain_data=t.data.chain.process_node,this.dialog=!0,console.log("this.select_chain_data",this.select_chain_data),this.$nextTick((()=>{this.draw_tree()})))}))},get_clientids(){f().get("/api/v1/get/process_chain/all",{"Content-Type":"application/json"}).then((e=>{const t=e.data;t.data&&(this.server_threat={data:[]},console.log(this),this.server_threat.data=t.data,console.log("duck",this.server_threat,"data",t.data))}))}},mounted(){this.get_clientids(),setInterval((()=>{this.last_refresh-=1,this.last_refresh<=0&&(this.get_clientids(),this.last_refresh=360)}),1e3)}});var q=i(4260),_=i(1432),S=i(3424),D=i(151),y=i(5589),E=i(9367),x=i(7030),Z=i(9400),K=i(9815),Y=i(846),W=i(2025),F=i(5528),N=i(677),z=i(7518),O=i.n(z);const X=(0,q.Z)(I,[["render",V]]),H=X;O()(I,"components",{QTimeline:_.Z,QTimelineEntry:S.Z,QCard:D.Z,QCardSection:y.Z,QCardActions:E.Z,QChip:x.Z,QBtn:Z.Z,QDialog:K.Z,QBar:Y.Z,QSpace:W.Z,QTooltip:F.Z}),O()(I,"directives",{ClosePopup:N.Z})}}]);